(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))p(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&p(h)}).observe(document,{childList:!0,subtree:!0});function g(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function p(s){if(s.ep)return;s.ep=!0;const l=g(s);fetch(s.href,l)}})();document.addEventListener("DOMContentLoaded",()=>{const d=document.getElementById("categories"),u=document.getElementById("comparison-area"),g=document.getElementById("search-input"),p=document.getElementById("no-item-selected"),s=document.getElementById("theme-toggle"),l=document.getElementById("light-icon"),h=document.getElementById("dark-icon"),L=document.getElementById("theme-text");let E=[],y=null;function S(){const e=localStorage.getItem("theme");e==="dark"?f():e==="light"?I():window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&f()}function f(){document.body.classList.add("dark-theme"),l.style.display="none",h.style.display="block",L.textContent="Chế độ sáng",localStorage.setItem("theme","dark")}function I(){document.body.classList.remove("dark-theme"),l.style.display="block",h.style.display="none",L.textContent="Chế độ tối",localStorage.setItem("theme","light")}s.addEventListener("click",()=>{document.body.classList.contains("dark-theme")?I():f()}),S();async function w(){try{const e="https://raw.githubusercontent.com/kienbb/MU-Art-Compare/main/docs/data.json";console.log("Fetching data directly from GitHub:",e);const t=await fetch(e);if(!t.ok)throw console.error(`Failed to fetch from GitHub raw. Status: ${t.status}`),new Error(`HTTP error! status: ${t.status}`);y=await t.json(),b(y.categories),k(y.categories)}catch(e){console.error("Could not fetch data:",e),d.innerHTML='<p style="color: red;">Lỗi tải dữ liệu. Vui lòng kiểm tra kết nối mạng và thử lại.</p>'}}function b(e){d.innerHTML="";const t=document.createElement("ul");if(t.classList.add("category-tree"),!e||Object.keys(e).length===0){const n=document.createElement("p");n.textContent='Không có dữ liệu danh mục. Vui lòng thêm dữ liệu vào thư mục assets và chạy "npm run scan".',n.style.color="red",d.appendChild(n);return}for(const n in e){const c=e[n];if(c&&c.length>0){const o=document.createElement("li");o.classList.add("category-node");const a=document.createElement("span");a.textContent=n,a.classList.add("category-title"),o.appendChild(a);const i=document.createElement("ul");i.classList.add("item-list"),c.forEach(r=>{const m=document.createElement("li");m.classList.add("item-node"),m.textContent=`${r.id?r.id+" - ":""}${r.name}`,m.dataset.category=n,m.dataset.itemId=r.id||r.name.replace(/ /g,"_"),m.addEventListener("click",C=>{C.stopPropagation(),M(r)}),i.appendChild(m)}),o.appendChild(i),a.addEventListener("click",()=>{o.classList.toggle("expanded")}),t.appendChild(o)}else{const o=document.createElement("li");o.classList.add("category-node");const a=document.createElement("span");a.textContent=n,a.classList.add("category-title"),o.appendChild(a);const i=document.createElement("p");i.textContent="Không có mục nào trong danh mục này",i.style.fontSize="0.9em",i.style.fontStyle="italic",i.style.marginLeft="20px",o.appendChild(i),t.appendChild(o)}}d.appendChild(t)}function k(e){E=[];for(const t in e)e[t].forEach(n=>{E.push(n)})}function M(e){u.innerHTML="",p&&(p.style.display="none");const t=document.querySelector("#content h2");t.textContent=`So sánh chi tiết - ${e.id?e.id+" - ":""}${e.name}`;const n=x("MU Awaken",e.images.awaken),c=x("MU Origin",e.images.origin);u.appendChild(n),u.appendChild(c),T(e)}function x(e,t){const n=document.createElement("div");n.classList.add("image-container");const c=document.createElement("h4");if(c.textContent=e,n.appendChild(c),t.length>0)t.forEach(o=>{const a=document.createElement("div");a.classList.add("image-preview-container"),n.appendChild(a);const i=document.createElement("img");i.src=o,i.alt=`${e} image`,a.appendChild(i)});else{const o=document.createElement("p");o.textContent="Không có hình ảnh.",n.appendChild(o)}return n}function T(e){const t=d.querySelector(".selected-item");t&&t.classList.remove("selected-item");const n=`${e.id?e.id+" - ":""}${e.name}`,c=d.querySelectorAll(".item-node");for(const o of c)if(o.textContent===n&&o.dataset.category===e.category){o.classList.add("selected-item");const a=o.closest(".category-node");a&&a.classList.add("expanded");break}}function A(){const e=g.value.toLowerCase().trim(),t=d.querySelectorAll(".category-node"),n=d.querySelectorAll(".item-node");if(e===""){n.forEach(c=>c.style.display="list-item"),t.forEach(c=>{c.style.display="list-item",c.classList.remove("expanded")});return}t.forEach(c=>{const a=c.querySelector(".item-list").querySelectorAll(".item-node");let i=!1;a.forEach(r=>{const m=r.textContent.toLowerCase(),C=r.dataset.itemId.toLowerCase(),v=m.includes(e)||C.includes(e);r.style.display=v?"list-item":"none",v&&(i=!0)}),c.style.display=i?"list-item":"none",i?c.classList.add("expanded"):c.classList.remove("expanded")})}g.addEventListener("input",A),w()});
