(function(){const h=document.createElement("link").relList;if(h&&h.supports&&h.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))g(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&g(p)}).observe(document,{childList:!0,subtree:!0});function f(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function g(c){if(c.ep)return;c.ep=!0;const d=f(c);fetch(c.href,d)}})();document.addEventListener("DOMContentLoaded",()=>{const l=document.getElementById("categories");document.getElementById("comparison-area");const h=document.getElementById("search-input");document.getElementById("no-item-selected");const f=document.getElementById("theme-toggle"),g=document.getElementById("light-icon"),c=document.getElementById("dark-icon"),d=document.getElementById("theme-text");let p=[],C=null;function v(){const e=localStorage.getItem("theme");e==="dark"?L():e==="light"?E():window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&L()}function L(){document.body.classList.add("dark-theme"),g.style.display="none",c.style.display="block",d.textContent="Chế độ sáng",localStorage.setItem("theme","dark")}function E(){document.body.classList.remove("dark-theme"),g.style.display="block",c.style.display="none",d.textContent="Chế độ tối",localStorage.setItem("theme","light")}f.addEventListener("click",()=>{document.body.classList.contains("dark-theme")?E():L()}),v();async function x(){try{const e="https://raw.githubusercontent.com/kienbb/MU-Art-Compare/main/docs/data.json";console.log("Fetching data directly from GitHub:",e);const n=await fetch(e);if(!n.ok)throw console.error(`Failed to fetch from GitHub raw. Status: ${n.status}`),new Error(`HTTP error! status: ${n.status}`);C=await n.json(),b(C.categories),S(C.categories)}catch(e){console.error("Could not fetch data:",e),l.innerHTML='<p style="color: red;">Lỗi tải dữ liệu. Vui lòng kiểm tra kết nối mạng và thử lại.</p>'}}function b(e){l.innerHTML="";const n=document.createElement("ul");n.classList.add("category-tree");const i=document.getElementById("content");if(i.innerHTML=`
            <div class="content-header">
                <h2>So sánh chi tiết</h2>
            </div>
            <div class="content-body">
                <div id="comparison-area">
                    <p id="no-item-selected">Chọn một mục từ danh sách bên trái để xem so sánh.</p>
                </div>
            </div>
        `,!e||Object.keys(e).length===0){const t=document.createElement("p");t.textContent='Không có dữ liệu danh mục. Vui lòng thêm dữ liệu vào thư mục assets và chạy "npm run scan".',t.style.color="red",l.appendChild(t);return}for(const t in e){const s=e[t];if(s&&s.length>0){const o=document.createElement("li");o.classList.add("category-node");const a=document.createElement("span");a.textContent=t,a.classList.add("category-title"),o.appendChild(a);const r=document.createElement("ul");r.classList.add("item-list"),s.forEach(m=>{const u=document.createElement("li");u.classList.add("item-node"),u.textContent=`${m.id?m.id+" - ":""}${m.name}`,u.dataset.category=t,u.dataset.itemId=m.id||m.name.replace(/ /g,"_"),u.addEventListener("click",y=>{y.stopPropagation(),w(m)}),r.appendChild(u)}),o.appendChild(r),a.addEventListener("click",()=>{o.classList.toggle("expanded")}),n.appendChild(o)}else{const o=document.createElement("li");o.classList.add("category-node");const a=document.createElement("span");a.textContent=t,a.classList.add("category-title"),o.appendChild(a);const r=document.createElement("p");r.textContent="Không có mục nào trong danh mục này",r.style.fontSize="0.9em",r.style.fontStyle="italic",r.style.marginLeft="20px",o.appendChild(r),n.appendChild(o)}}l.appendChild(n)}function S(e){p=[];for(const n in e)e[n].forEach(i=>{p.push(i)})}function w(e){const n=document.getElementById("comparison-area");n.innerHTML="";const i=document.querySelector(".content-header h2");i.textContent=`So sánh chi tiết - ${e.id?e.id+" - ":""}${e.name}`;const t=I("MU Awaken",e.images.awaken),s=I("MU Origin",e.images.origin);n.appendChild(t),n.appendChild(s),k(e)}function I(e,n){const i=document.createElement("div");i.classList.add("image-container");const t=document.createElement("h4");if(t.textContent=e,i.appendChild(t),n.length>0)n.forEach(s=>{const o=document.createElement("div");o.classList.add("image-preview-container"),i.appendChild(o);const a=document.createElement("img");a.src=s,a.alt=`${e} image`,o.appendChild(a)});else{const s=document.createElement("p");s.textContent="Không có hình ảnh.",i.appendChild(s)}return i}function k(e){const n=l.querySelector(".selected-item");n&&n.classList.remove("selected-item");const i=`${e.id?e.id+" - ":""}${e.name}`,t=l.querySelectorAll(".item-node");for(const s of t)if(s.textContent===i&&s.dataset.category===e.category){s.classList.add("selected-item");const o=s.closest(".category-node");o&&o.classList.add("expanded");break}}function M(){const e=h.value.toLowerCase().trim(),n=l.querySelectorAll(".category-node"),i=l.querySelectorAll(".item-node");if(e===""){i.forEach(t=>t.style.display="list-item"),n.forEach(t=>{t.style.display="list-item",t.classList.remove("expanded")});return}n.forEach(t=>{const o=t.querySelector(".item-list").querySelectorAll(".item-node");let a=!1;o.forEach(r=>{const m=r.textContent.toLowerCase(),u=r.dataset.itemId.toLowerCase(),y=m.includes(e)||u.includes(e);r.style.display=y?"list-item":"none",y&&(a=!0)}),t.style.display=a?"list-item":"none",a?t.classList.add("expanded"):t.classList.remove("expanded")})}h.addEventListener("input",M),x()});
